<div class="container-fluid py-4">

    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h3 class="fw-bold mb-1">Users</h3>
            <small class="text-muted">Manage user records easily</small>
        </div>

        <button class="btn btn-primary px-4" routerLink="/users/create">
            <i class="bi bi-person-plus-fill me-2"></i>
            Add User
        </button>
    </div>

    <!-- Filters Card -->
    <div class="card shadow-sm border-0 rounded-4 mb-4">
        <div class="card-body p-4">

            <div class="row g-3 align-items-end">

                <div class="col-md-4">
                    <label class="form-label small text-muted">Search</label>
                    <input type="text" class="form-control"
                        placeholder="Search by name or city"
                        [(ngModel)]="searchText"
                        (input)="applyFilters()">
                </div>

                <div class="col-md-3">
                    <label class="form-label small text-muted">Gender</label>
                    <select class="form-select"
                        [(ngModel)]="selectedGender"
                        (change)="applyFilters()">
                        <option value="">All</option>
                        <option>Male</option>
                        <option>Female</option>
                        <option>Other</option>
                    </select>
                </div>

                <div class="col-md-3">
                    <label class="form-label small text-muted">Date of Birth</label>
                    <input type="date" class="form-control"
                        [(ngModel)]="selectedDate"
                        (change)="applyFilters()">
                </div>

                <div class="col-md-2">
                    <button class="btn btn-outline-secondary w-100"
                        (click)="resetFilters()">
                        Reset
                    </button>
                </div>

            </div>

        </div>
    </div>

    <!-- Grid Card -->
    <div class="card shadow-sm border-0 rounded-4">
        <div class="card-body p-3">

            <kendo-grid
                [data]="filteredUsers"
                [height]="550"
                [sortable]="true"
                [filterable]="true"
                [pageable]="{
                    buttonCount: 5,
                    info: true,
                    type: 'numeric',
                    pageSizes: [5, 10, 20]
                }"
                [pageSize]="5"
                [resizable]="true"
                [reorderable]="true"
                class="kendo-modern-grid">

                <!-- Serial Number -->
                <kendo-grid-column title="#" [width]="70">
                    <ng-template kendoGridCellTemplate let-rowIndex="rowIndex">
                        <span class="fw-semibold text-muted">
                            {{ rowIndex + 1 }}
                        </span>
                    </ng-template>
                </kendo-grid-column>

                <!-- First Name -->
                <kendo-grid-column field="firstName" title="First Name" [width]="150">
                </kendo-grid-column>

                <!-- Last Name -->
                <kendo-grid-column field="lastName" title="Last Name" [width]="150">
                </kendo-grid-column>

                <!-- Gender -->
                <kendo-grid-column field="gender" title="Gender" [width]="120">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <span class="badge px-3 py-2 rounded-pill"
                            [ngClass]="{
                                'bg-primary-subtle text-primary': dataItem.gender === 'Male',
                                'bg-danger-subtle text-danger': dataItem.gender === 'Female',
                                'bg-secondary-subtle text-secondary': dataItem.gender === 'Other'
                            }">
                            {{ dataItem.gender }}
                        </span>
                    </ng-template>
                </kendo-grid-column>

                <!-- City -->
                <kendo-grid-column field="city" title="City" [width]="150">
                </kendo-grid-column>

                <!-- DOB -->
                <kendo-grid-column field="dob" title="Date of Birth" [width]="160">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        {{ dataItem.dob | date:'dd MMM yyyy' }}
                    </ng-template>
                </kendo-grid-column>

                <!-- Actions -->
                <kendo-grid-column title="Actions" [width]="220">
                    <ng-template kendoGridCellTemplate let-dataItem>
                        <div class="d-flex gap-2">
                            <button
                                class="btn btn-sm btn-light border shadow-sm"
                                (click)="openEditModal(dataItem)"
                                data-bs-toggle="modal"
                                data-bs-target="#editUserModal">
                                ‚úè Edit
                            </button>

                            <button
                                class="btn btn-sm btn-light text-danger border shadow-sm"
                                (click)="deleteUser(dataItem.id)">
                                üóë Delete
                            </button>
                        </div>
                    </ng-template>
                </kendo-grid-column>

            </kendo-grid>

        </div>
    </div>
</div>
<div class="modal fade" id="editUserModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 border-0 shadow">

            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold">
                    <i class="bi bi-pencil-square me-2 text-primary"></i>
                    Edit User
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body pt-2">

                <form class="row g-3">

                    <div class="col-md-6">
                        <label class="form-label small text-muted">First Name</label>
                        <input type="text" class="form-control"
                            [(ngModel)]="selectedUser.firstName"
                            name="firstName">
                    </div>

                    <div class="col-md-6">
                        <label class="form-label small text-muted">Last Name</label>
                        <input type="text" class="form-control"
                            [(ngModel)]="selectedUser.lastName"
                            name="lastName">
                    </div>

                    <div class="col-md-6">
                        <label class="form-label small text-muted">Gender</label>
                        <select class="form-select"
                            [(ngModel)]="selectedUser.gender"
                            name="gender">
                            <option>Male</option>
                            <option>Female</option>
                            <option>Other</option>
                        </select>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label small text-muted">City</label>
                        <input type="text" class="form-control"
                            [(ngModel)]="selectedUser.city"
                            name="city">
                    </div>

                    <div class="col-12">
                        <label class="form-label small text-muted">Date of Birth</label>
                        <input type="date" class="form-control"
                            [(ngModel)]="selectedUser.dob"
                            name="dob">
                    </div>

                </form>

            </div>

            <div class="modal-footer border-0 pt-0">
                <button type="button"
                    class="btn btn-outline-secondary px-4"
                    data-bs-dismiss="modal">
                    Cancel
                </button>

                <button type="button"
                    class="btn btn-primary px-4"
                    (click)="updateUser()"
                    data-bs-dismiss="modal">
                    Save Changes
                </button>
            </div>

        </div>
    </div>
</div>
